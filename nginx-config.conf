# ============================================
# Configuração Nginx - URLs Curtas/Abreviadas
# Projeto: Achei na Ilha
# ============================================

server {
    listen 80;
    listen [::]:80;
    server_name acheinailha.com.br www.acheinailha.com.br;
    
    # Redirecionar HTTP para HTTPS (opcional, mas recomendado)
    return 301 https://$server_name$request_uri;
}

server {
    listen 443 ssl http2;
    listen [::]:443 ssl http2;
    server_name acheinailha.com.br www.acheinailha.com.br;
    
    # Configurações SSL (ajuste conforme seu certificado)
    # ssl_certificate /etc/ssl/certs/acheinailha.com.br.crt;
    # ssl_certificate_key /etc/ssl/private/acheinailha.com.br.key;
    
    # Raiz do site
    root /var/www/acheinailha;  # Ajuste para o caminho real do seu projeto
    index index.html;
    
    # ============================================
    # URLs CURTAS - PROPERTY (Propriedades)
    # ============================================
    
    # Busca de imóveis
    location = /busca {
        rewrite ^ /pages/property/busca.html permanent;
    }
    
    # Detalhes do imóvel (com parâmetro ID)
    location = /detalhes {
        rewrite ^ /pages/property/detalhes.html permanent;
    }
    
    # Novo anúncio
    location = /novo-anuncio {
        rewrite ^ /pages/property/novo-anuncio.html permanent;
    }
    
    # ============================================
    # URLs CURTAS - AUTH (Autenticação)
    # ============================================
    
    # Login
    location = /login {
        rewrite ^ /pages/auth/login.html permanent;
    }
    
    # Cadastro
    location = /cadastro {
        rewrite ^ /pages/auth/cadastro.html permanent;
    }
    
    # Confirmar email
    location = /confirmar-email {
        rewrite ^ /pages/auth/confirmar-email.html permanent;
    }
    
    # ============================================
    # URLs CURTAS - USER (Usuário)
    # ============================================
    
    # Meus anúncios
    location = /meus-anuncios {
        rewrite ^ /pages/user/meus-anuncios.html permanent;
    }
    
    # Configurações do usuário
    location = /configuracoes {
        rewrite ^ /pages/user/configuracoes.html permanent;
    }
    
    # Escolha de plano
    location = /escolha-plano {
        rewrite ^ /pages/user/escolha-plano.html permanent;
    }
    
    # ============================================
    # URLs CURTAS - PAYMENT (Pagamento)
    # ============================================
    
    # Pagamento
    location = /pagamento {
        rewrite ^ /pages/payment/pagamento.html permanent;
    }
    
    # ============================================
    # URLs CURTAS - ADMIN (Administração)
    # ============================================
    
    # Painel administrativo
    location = /admin {
        rewrite ^ /pages/admin/admin.html permanent;
    }
    
    # Login administrativo
    location = /admin-login {
        rewrite ^ /pages/admin/login.html permanent;
    }
    
    # ============================================
    # REDIRECIONAMENTOS 301 (SEO - Antigo para Novo)
    # ============================================
    # Redireciona URLs antigas para as novas curtas
    
    # Property
    location = /pages/property/busca.html {
        return 301 /busca;
    }
    location = /pages/property/detalhes.html {
        return 301 /detalhes;
    }
    location = /pages/property/novo-anuncio.html {
        return 301 /novo-anuncio;
    }
    
    # Auth
    location = /pages/auth/login.html {
        return 301 /login;
    }
    location = /pages/auth/cadastro.html {
        return 301 /cadastro;
    }
    location = /pages/auth/confirmar-email.html {
        return 301 /confirmar-email;
    }
    
    # User
    location = /pages/user/meus-anuncios.html {
        return 301 /meus-anuncios;
    }
    location = /pages/user/configuracoes.html {
        return 301 /configuracoes;
    }
    location = /pages/user/escolha-plano.html {
        return 301 /escolha-plano;
    }
    
    # Payment
    location = /pages/payment/pagamento.html {
        return 301 /pagamento;
    }
    
    # Admin
    location = /pages/admin/admin.html {
        return 301 /admin;
    }
    location = /pages/admin/login.html {
        return 301 /admin-login;
    }
    
    # ============================================
    # CONFIGURAÇÕES GERAIS
    # ============================================
    
    # Arquivos estáticos (CSS, JS, imagens, etc.)
    location ~* \.(css|js|jpg|jpeg|png|gif|ico|svg|woff|woff2|ttf|eot)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
        access_log off;
    }
    
    # Arquivos HTML
    location ~ \.html$ {
        try_files $uri $uri/ =404;
        add_header Cache-Control "no-cache, no-store, must-revalidate";
    }
    
    # Página inicial (index.html)
    location = / {
        try_files /index.html =404;
    }
    
    # Fallback para arquivos estáticos
    location / {
        try_files $uri $uri/ $uri.html =404;
    }
    
    # Segurança - Negar acesso a arquivos ocultos
    location ~ /\. {
        deny all;
        access_log off;
        log_not_found off;
    }
    
    # Logs
    access_log /var/log/nginx/acheinailha-access.log;
    error_log /var/log/nginx/acheinailha-error.log;
}

